<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Knight Race vs Bot</title>
<style>
  body {
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    min-height: 100vh;
    margin: 0;
    background: linear-gradient(135deg, #2c3e50, #34495e);
    font-family: "Segoe UI", sans-serif;
    color: #fff;
  }

  h1 { margin-bottom: 5px; font-size: 2.2rem; text-shadow: 2px 2px 4px rgba(0,0,0,0.6); }
  #status { margin-bottom: 15px; font-size: 1.2rem; }

  #board {
    display: grid;
    grid-template-columns: repeat(8, 70px);
    grid-template-rows: repeat(8, 70px);
    background: #b58863;
    box-shadow: 0 8px 20px rgba(0,0,0,0.4);
    border-radius: 12px;
    overflow: hidden;
  }

  .square {
    width: 70px;
    height: 70px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 46px;
    transition: transform 0.2s;
    font-family: "DejaVu Sans", "Segoe UI Symbol", sans-serif;
  }

  .light { background: #f0d9b5; }
  .dark { background: #b58863; }

  .target {
    background: radial-gradient(circle, #4caf50, #2e7d32) !important;
    box-shadow: inset 0 0 15px #66ff99;
  }

  .knight1 { color: black; }
  .knight2 { color: white; text-shadow: 0 0 6px #000; }

  .highlight {
    cursor: pointer;
    box-shadow: 0 0 0 3px yellow;
    z-index: 1;
    transition: transform 0.2s, box-shadow 0.2s;
  }

  .highlight:hover {
    transform: scale(1.1);
    box-shadow: 0 0 10px 3px yellow;
  }

  #overlay {
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(0,0,0,0.8);
    display: flex;
    align-items: center;
    justify-content: center;
    flex-direction: column;
    color: #fff;
    font-size: 2rem;
    visibility: hidden;
  }

  #restart {
    margin-top: 20px;
    padding: 10px 20px;
    font-size: 1rem;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    background: #3498db;
    color: white;
    transition: background 0.2s;
  }
  #restart:hover { background: #2980b9; }
</style>
</head>
<body>
<h1>⚔️ Knight Race vs Bot</h1>
<div id="status">Your turn (Black Knight)</div>
<div id="board"></div>

<div id="overlay">
  <div id="winnerText"></div>
  <button id="restart">Restart Game</button>
</div>

<script>
const board = document.getElementById("board");
const status = document.getElementById("status");
const overlay = document.getElementById("overlay");
const winnerText = document.getElementById("winnerText");
const restartBtn = document.getElementById("restart");

const size = 8;
let playerPos, botPos, targetPos, gameOver;

function initGame() {
  playerPos = [0, 0];
  botPos = [7, 7];
  do { targetPos = [Math.floor(Math.random()*size), Math.floor(Math.random()*size)];
  } while ((targetPos[0]===0 && targetPos[1]===0) || (targetPos[0]===7 && targetPos[1]===7));

  gameOver = false;
  overlay.style.visibility = "hidden";
  status.textContent = "Your turn (Black Knight)";
  drawBoard();
}

function isSamePos(a,b){return a[0]===b[0] && a[1]===b[1];}

function knightMoves([x,y]){
  const moves = [
    [x+2,y+1],[x+2,y-1],[x-2,y+1],[x-2,y-1],
    [x+1,y+2],[x+1,y-2],[x-1,y+2],[x-1,y-2]
  ];
  return moves.filter(([nx,ny])=>nx>=0&&nx<size&&ny>=0&&ny<size);
}

function drawBoard(){
  board.innerHTML="";
  for(let y=0;y<size;y++){
    for(let x=0;x<size;x++){
      const square=document.createElement("div");
      square.className="square "+((x+y)%2===0?"light":"dark");

      if(isSamePos([x,y], targetPos)) square.classList.add("target");
      if(isSamePos([x,y], playerPos)) square.innerHTML="♞", square.classList.add("knight1");
      if(isSamePos([x,y], botPos)) square.innerHTML="♘", square.classList.add("knight2");

      // highlight player's moves
      if(!gameOver){
        knightMoves(playerPos).forEach(([mx,my])=>{
          if(mx===x && my===y){
            square.classList.add("highlight");
            square.onclick=()=>playerMove([mx,my]);
          }
        });
      }
      board.appendChild(square);
    }
  }
}

function playerMove(newPos){
  if(gameOver) return;
  playerPos=newPos;
  if(isSamePos(playerPos,targetPos)){
    showWinner("You (Black Knight) win!");
    return;
  }
  drawBoard();
  status.textContent="Bot's turn (White Knight)";
  setTimeout(botMove, 500); // small delay to see bot move
}

function botMove(){
  if(gameOver) return;
  const moves=knightMoves(botPos);
  // choose move minimizing Manhattan distance to target
  let bestMove=moves[0];
  let minDist=Math.abs(bestMove[0]-targetPos[0])+Math.abs(bestMove[1]-targetPos[1]);
  moves.forEach(([x,y])=>{
    const dist=Math.abs(x-targetPos[0])+Math.abs(y-targetPos[1]);
    if(dist<minDist){ minDist=dist; bestMove=[x,y]; }
  });
  botPos=bestMove;
  if(isSamePos(botPos,targetPos)){
    showWinner("Bot (White Knight) wins!");
    return;
  }
  drawBoard();
  status.textContent="Your turn (Black Knight)";
}

function showWinner(text){
  gameOver=true;
  winnerText.textContent=text;
  overlay.style.visibility="visible";
}

restartBtn.onclick=initGame;
initGame();
</script>
</body>
</html>
